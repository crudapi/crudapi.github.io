(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{367:function(a,t,r){"use strict";r.r(t);var e=r(42),s=Object(e.a)({},(function(){var a=this,t=a.$createElement,r=a._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[r("h1",{attrs:{id:"基于vue和quasar的前端spa项目实战之docker部署-八"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#基于vue和quasar的前端spa项目实战之docker部署-八"}},[a._v("#")]),a._v(" 基于Vue和Quasar的前端SPA项目实战之docker部署（八）")]),a._v(" "),r("h2",{attrs:{id:"回顾"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#回顾"}},[a._v("#")]),a._v(" 回顾")]),a._v(" "),r("p",[a._v("通过上一篇文章"),r("RouterLink",{attrs:{to:"/crudapi-admin-web/business.html"}},[a._v(" 基于Vue和Quasar的前端SPA项目实战之业务数据（七）")]),a._v("的介绍，crudapi-admin-web基本功能全部实现了，本文主要介绍前端打包和docker部署相关内容。")],1),a._v(" "),r("h2",{attrs:{id:"简介"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[a._v("#")]),a._v(" 简介")]),a._v(" "),r("p",[a._v("Docker是一个开源的应用容器引擎，让开发者可以打包他们的应用以及依赖包到一个可移植的镜像中，然后发布到任何流行的 Linux或Windows 机器上，也可以实现虚拟化。容器是完全使用沙箱机制，相互之间不会有任何接口。采用docker技术可以很方便地实现持续集成和交付CI/CD。")]),a._v(" "),r("h2",{attrs:{id:"配置quasar-conf-js"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#配置quasar-conf-js"}},[a._v("#")]),a._v(" 配置quasar.conf.js")]),a._v(" "),r("div",{staticClass:"language-javascript extra-class"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[a._v("build"),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  vueRouterMode"),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[a._v("'history'")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  publicPath"),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[a._v("'/crudapi/'")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  distDir"),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),r("span",{pre:!0,attrs:{class:"token template-string"}},[r("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[a._v("`")]),r("span",{pre:!0,attrs:{class:"token string"}},[a._v("dist/")]),r("span",{pre:!0,attrs:{class:"token interpolation"}},[r("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[a._v("${")]),a._v("ctx"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("modeName"),r("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[a._v("}")])]),r("span",{pre:!0,attrs:{class:"token string"}},[a._v("/crudapi")]),r("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[a._v("`")])]),a._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),r("p",[a._v("通常将前端打包之后的文件放在一个子目录下，方便和其它系统集成，比如可以放在spring boot项目的resources/static/crudapi目录下，避免放在根目录，所以这里配置publicPath为crudapi。")]),a._v(" "),r("h2",{attrs:{id:"dockefile"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#dockefile"}},[a._v("#")]),a._v(" Dockefile")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("FROM node:lts-alpine as builder\n\nCOPY package.json /crudapi-admin-web/package.json\n\nWORKDIR /crudapi-admin-web\nRUN npm install\n\nCOPY . /crudapi-admin-web/\n\nWORKDIR /crudapi-admin-web\n\nRUN npm run build\n\nFROM nginx:latest\n\nWORKDIR /crudapi-admin-web\n\nCOPY --from=builder /crudapi-admin-web/dist/spa .\n\nCOPY ./docker/default.conf  /etc/nginx/conf.d/default.conf\n\nEXPOSE 80\n")])])]),r("p",[a._v("构建分为两个阶段：")]),a._v(" "),r("ol",[r("li",[a._v("利用node镜像编译打包")]),a._v(" "),r("li",[a._v("利用nginx镜像暴露80端口，提供http服务")])]),a._v(" "),r("p",[a._v("优化：\npackage.json放在第一步copy，目的是为了缓存，从而提高镜像构建速度，因为通常情况下package.json不会频繁修改，只要package.json不变，后面的npm install命令就不会重复构建。")]),a._v(" "),r("h2",{attrs:{id:"nginx配置"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#nginx配置"}},[a._v("#")]),a._v(" nginx配置")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("server {\n    listen       80;\n    server_name  localhost;\n\n    charset 'utf-8';\n    \n    error_page   500 502 503 504  /50x.html;\n    location = /50x.html {\n        root   /usr/share/nginx/html;\n    }\n\n    location ~ /api {\n      proxy_pass  http://demo.crudapi.cn;\n    }\n\n    location / {\n        root   /crudapi-admin-web;\n        index  index.html index.htm;\n        try_files $uri $uri/ /crudapi/index.html;\n    }\n}\n")])])]),r("p",[a._v("default.conf中主要配置两个location规则")]),a._v(" "),r("ol",[r("li",[a._v("api部分转发到http://demo.crudapi.cn，可以替换为其它有效地址")]),a._v(" "),r("li",[a._v("其它内容永远访问/crudapi-admin-web/crudapi/index.html，vue内部自动处理路由")])]),a._v(" "),r("h2",{attrs:{id:"dockerignore配置"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#dockerignore配置"}},[a._v("#")]),a._v(" .dockerignore配置")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v(".DS_Store\n.git\n.gitignore\nnode_modules\ndist\n.quasar\n.vscode\n.dockerignore\npackage-lock.json\nDockerfile\n*.md\n")])])]),r("p",[a._v("dockerignore排除的不需要的文件，避免构建过程中copy无用文件。")]),a._v(" "),r("h2",{attrs:{id:"docker命令"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#docker命令"}},[a._v("#")]),a._v(" docker命令")]),a._v(" "),r("p",[a._v("本地打包docker和运行")]),a._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[a._v("docker build -t crudapi-admin-web:latest "),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\ndocker "),r("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" -f crudapi-admin-web\ndocker run -d -p "),r("span",{pre:!0,attrs:{class:"token number"}},[a._v("80")]),a._v(":80 --name crudapi-admin-web crudapi-admin-web:latest\ndocker "),r("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),r("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" crudapi-admin-web\n")])])]),r("p",[a._v("最新的docker镜像已经自动上传到docker官网hub"),r("a",{attrs:{href:"https://hub.docker.com/repository/docker/crudapi/crudapi-admin-web",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://hub.docker.com/repository/docker/crudapi/crudapi-admin-web"),r("OutboundLink")],1),a._v("，直接pull也可以。")]),a._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[a._v("docker pull crudapi/crudapi-admin-web:latest\ndocker tag crudapi/crudapi-admin-web:latest crudapi-nginx:latest\n")])])]),r("h2",{attrs:{id:"进行验证"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#进行验证"}},[a._v("#")]),a._v(" 进行验证")]),a._v(" "),r("p",[r("img",{attrs:{src:"/img/crudapi-admin-web/docker/demo.png",alt:"demo"}}),a._v("\n访问 "),r("a",{attrs:{href:"http://127.0.0.1/crudapi",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://127.0.0.1/crudapi"),r("OutboundLink")],1)]),a._v(" "),r("h2",{attrs:{id:"小结"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[a._v("#")]),a._v(" 小结")]),a._v(" "),r("p",[a._v("本文主要介绍了vue前端打包和docker部署相关内容，到目前为止，crudapi-admin-web代码已经完成，后续会继续优化代码，文档也会持续更新。每一篇文章对应的代码，都打上了tag，命名规则为t1,t2..., 欢迎下载代码学习和交流。")]),a._v(" "),r("h2",{attrs:{id:"demo演示"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#demo演示"}},[a._v("#")]),a._v(" demo演示")]),a._v(" "),r("p",[a._v("官网地址："),r("a",{attrs:{href:"https://crudapi.cn",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://crudapi.cn"),r("OutboundLink")],1),r("br"),a._v("\n测试地址："),r("a",{attrs:{href:"https://demo.crudapi.cn/crudapi/login",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://demo.crudapi.cn/crudapi/login"),r("OutboundLink")],1)]),a._v(" "),r("h2",{attrs:{id:"附源码地址"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#附源码地址"}},[a._v("#")]),a._v(" 附源码地址")]),a._v(" "),r("h3",{attrs:{id:"github地址"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#github地址"}},[a._v("#")]),a._v(" GitHub地址")]),a._v(" "),r("p",[r("a",{attrs:{href:"https://github.com/crudapi/crudapi-admin-web",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/crudapi/crudapi-admin-web"),r("OutboundLink")],1)]),a._v(" "),r("h3",{attrs:{id:"gitee地址"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#gitee地址"}},[a._v("#")]),a._v(" Gitee地址")]),a._v(" "),r("p",[r("a",{attrs:{href:"https://gitee.com/crudapi/crudapi-admin-web",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://gitee.com/crudapi/crudapi-admin-web"),r("OutboundLink")],1)]),a._v(" "),r("p",[a._v("由于网络原因，GitHub可能速度慢，改成访问Gitee即可，代码同步更新。")]),a._v(" "),r("h2",{attrs:{id:"目录"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#目录"}},[a._v("#")]),a._v(" 目录")]),a._v(" "),r("h4",{attrs:{id:"基于vue和quasar的前端spa项目实战之环境搭建-一"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#基于vue和quasar的前端spa项目实战之环境搭建-一"}},[a._v("#")]),a._v(" "),r("RouterLink",{attrs:{to:"/crudapi-admin-web/helloworld.html"}},[a._v("基于Vue和Quasar的前端SPA项目实战之环境搭建（一）")])],1),a._v(" "),r("h4",{attrs:{id:"基于vue和quasar的前端spa项目实战之用户登录-二"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#基于vue和quasar的前端spa项目实战之用户登录-二"}},[a._v("#")]),a._v(" "),r("RouterLink",{attrs:{to:"/crudapi-admin-web/login.html"}},[a._v("基于Vue和Quasar的前端SPA项目实战之用户登录（二）")])],1),a._v(" "),r("h4",{attrs:{id:"基于vue和quasar的前端spa项目实战之布局菜单-三"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#基于vue和quasar的前端spa项目实战之布局菜单-三"}},[a._v("#")]),a._v(" "),r("RouterLink",{attrs:{to:"/crudapi-admin-web/layout.html"}},[a._v("基于Vue和Quasar的前端SPA项目实战之布局菜单（三）")])],1),a._v(" "),r("h4",{attrs:{id:"基于vue和quasar的前端spa项目实战之序列号-四"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#基于vue和quasar的前端spa项目实战之序列号-四"}},[a._v("#")]),a._v(" "),r("RouterLink",{attrs:{to:"/crudapi-admin-web/sequence.html"}},[a._v("基于Vue和Quasar的前端SPA项目实战之序列号（四）")])],1),a._v(" "),r("h4",{attrs:{id:"基于vue和quasar的前端spa项目实战之动态表单-五"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#基于vue和quasar的前端spa项目实战之动态表单-五"}},[a._v("#")]),a._v(" "),r("RouterLink",{attrs:{to:"/crudapi-admin-web/metadatatable.html"}},[a._v("基于Vue和Quasar的前端SPA项目实战之动态表单（五）")])],1),a._v(" "),r("h4",{attrs:{id:"基于vue和quasar的前端spa项目实战之表关系-六"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#基于vue和quasar的前端spa项目实战之表关系-六"}},[a._v("#")]),a._v(" "),r("RouterLink",{attrs:{to:"/crudapi-admin-web/metadatarelation.html"}},[a._v("基于Vue和Quasar的前端SPA项目实战之表关系（六）")])],1),a._v(" "),r("h4",{attrs:{id:"基于vue和quasar的前端spa项目实战之业务数据-七"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#基于vue和quasar的前端spa项目实战之业务数据-七"}},[a._v("#")]),a._v(" "),r("RouterLink",{attrs:{to:"/crudapi-admin-web/business.html"}},[a._v("基于Vue和Quasar的前端SPA项目实战之业务数据（七）")])],1),a._v(" "),r("h4",{attrs:{id:"基于vue和quasar的前端spa项目实战之docker部署-八-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#基于vue和quasar的前端spa项目实战之docker部署-八-2"}},[a._v("#")]),a._v(" "),r("RouterLink",{attrs:{to:"/crudapi-admin-web/docker.html"}},[a._v("基于Vue和Quasar的前端SPA项目实战之docker部署（八）")])],1)])}),[],!1,null,null,null);t.default=s.exports}}]);